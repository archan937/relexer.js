if(typeof(reLexer)=="undefined"){reLexer=function(l,i,h){i||(i=Object.keys(l).pop());var g,d,e,f,b,c=function(r){if(typeof(r)=="string"){r=new RegExp(r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))}var q=g.match(r);if(q&&q.index==0){g=g.slice(q[0].length);return q[0]}},j=function(t,q){var v=t.match(/(.+?)(>(\w+))?(&)?(\?)?$/)||[],w=v[1],r=v[3],s=q||!!v[4],x=!!v[5],y=((w||"").match(/:(\w+)/)||[])[1],u;if(r||x||(y&&l[y])){if(w.match(/\|/)){w=reLexer.or.apply(null,w.split("|"))}else{w=w.replace(":","")}u=n(w,r,s);if((u==undefined)&&x){u=""}}else{u=c(t)}return u},p=function(v,r){v._conj_||(v._conj_="and");var y=g,q=v._conj_,s,x,w,u,t=[];for(s=0;s<v.length;s++){x=v[s];w=g+" -> "+x;if(f.indexOf(w)==-1){f.push(w);u=n(x,null,r);f.splice(f.indexOf(w),1);if(u!=undefined){if(q=="and"){t.push(u)}else{return u}}else{if(q=="and"){g=y;return}}}}if(t.length){return t}},n=function(u,q,r){var z=g,w=!u,y=u||i,x=l[y],t=d&&d[y],v,s;if(!x){y=undefined;x=u}b.push(g+" (#"+b.length+") "+x.toString());switch(x.constructor){case RegExp:v=c(x);break;case String:v=j(x,r);break;case Array:v=p(x,r);break}if((v!=undefined)||(z!=g)){if(y||q){if(!e||t){v=k(q,r,y,x,v)}if(e&&t){s=function(){return t(e,this.captures,this)}.bind(v);v=r?s:s()}}if(e&&q){v=[q,v];v._named_=true}return v}else{if(w){throw"Unable to match expression: "+JSON.stringify(g)+" (rule: "+y+")"}}},k=function(q,r,x,w,v){var s={},t={},y,u;if(q){s.name=q}if(r){s.lazy=r}if(x){s.rule=x}s.pattern=w;if(w._conj_){s.conjunction=w._conj_}if(e&&(v.constructor==Array)){for(u=0;u<v.length;u++){y=v[u];if(y&&y._named_){t[y[0]]=y[1]}}}s.captures=Object.keys(t).length?m(t):v;return s},m=function(q){return new Proxy(q,{get:function(r,s){var t=r[s];return(t&&t.constructor==Function)?t():t}})},o=function(){var r,q;try{r=n();return g.length?o():r}catch(s){q=s.message&&s.message.match("Maximum call stack size exceeded")?-30:-15;console.error(s);console.error("Expressions backtrace:\n"+b.slice(q).reverse().join("\n"))}},a=function(r,s,q){r=r.trim();if(r){g=r;d=s||h;e=q;f?f.splice(0):(f=[]);b?b.splice(0):(b=[]);return o()}};this.tokenize=function(q){return a(q)};this.parse=function(s,q,r){return a(s,r,q||{})}};or=reLexer.or=function(){var a=[].slice.call(arguments);a._conj_="or";return a}};